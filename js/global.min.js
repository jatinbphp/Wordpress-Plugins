jQuery(function($){
	var searchRequest;
	$('#search_all_data').autoComplete({
		minChars: 2,
		source: function(term, suggest){
			 
			 
			try { searchRequest.abort(); } catch(e){}
			
			searchRequest = $.ajax({
								url: global.ajax,
								type: "post",
								dataType: "json",
								cache: false,
								data: {
									search: term, action: 'search_site'
								},
								beforeSend: function() {
									$('#search_all_data').addClass('csf_loading'); 
								},
								success: function (res) {
									if (!res.data.length) {
										var result = [{ value: "No results", url: '' }];
										suggest(result);
									}
									else {
										suggest($.map(res.data, function (item) {
											return { url: item.url, value: item.value };
										}));
									}
									
									$('#search_all_data').removeClass('csf_loading'); 
								}
							});
			
			
		
		},
		renderItem: function (item, search){
				return '<div class="search_result"><a href="' + item.url + '">' + item.value + '</a></div>';
		},
		onSelect: function(e, term, item) {
			var link = item.data('url');
			window.open(link); 
		}
  });
});

